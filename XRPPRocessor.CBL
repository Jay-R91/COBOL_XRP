IDENTIFICATION DIVISION.
PROGRAM-ID. XRP-PROCESSOR.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT BALANCE-FILE ASSIGN TO "balance.dat"
        ORGANIZATION IS LINE SEQUENTIAL
        ACCESS MODE IS SEQUENTIAL
        FILE STATUS IS FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD BALANCE-FILE.
01 BALANCE-RECORD PIC X(7).  *> 7-digit string for balance in cents (e.g., "0008548")

WORKING-STORAGE SECTION.
01 FILE-STATUS          PIC X(2).
01 WS-BALANCE-CENTS     PIC 9(7).    *> Balance in cents (e.g., 85480)
01 WS-BALANCE-DOLLARS   PIC 9(5)V99. *> For calculations (e.g., 85.48)
01 WS-DISPLAY-BALANCE   PIC $ZZ,ZZ9.99.  *> Formatted display (e.g., "$85.48")
01 WS-RAW-BALANCE       PIC X(7).    *> Raw input from file
01 WS-BALANCE-STR       PIC 9(7).    *> 7-digit string for writing
01 SENDER               PIC X(20).
01 RECEIVER             PIC X(20).
01 AMOUNT               PIC 9(5)V99. *> Transaction amount (e.g., 20.00)
01 WS-AMOUNT-CENTS      PIC 9(7).    *> Amount in cents (e.g., 2000)

PROCEDURE DIVISION.
MAIN-PROCEDURE SECTION.
    PERFORM INITIALIZE-BALANCE
    PERFORM GET-INPUT
    PERFORM PROCESS-TRANSACTION
    STOP RUN.

INITIALIZE-BALANCE SECTION.
    OPEN INPUT BALANCE-FILE
    IF FILE-STATUS = "35"  *> File not found
        CLOSE BALANCE-FILE
        OPEN OUTPUT BALANCE-FILE
        MOVE 8548 TO WS-BALANCE-CENTS  *> Default $85.48 as 8548 cents
        MOVE WS-BALANCE-CENTS TO WS-BALANCE-STR
        STRING WS-BALANCE-STR DELIMITED BY SIZE INTO BAL
