IDENTIFICATION DIVISION.
PROGRAM-ID. XRP-PROCESSOR.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT BALANCE-FILE ASSIGN TO "balance.dat"
        ORGANIZATION IS LINE SEQUENTIAL
        ACCESS MODE IS SEQUENTIAL
        FILE STATUS IS FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD BALANCE-FILE.
01 BALANCE-RECORD.
    05 BALANCE-AMOUNT   PIC 9(5)V99.

WORKING-STORAGE SECTION.
01 FILE-STATUS          PIC X(2).
01 AMOUNT               PIC 9(5)V99.
01 SENDER               PIC X(20).
01 RECEIVER             PIC X(20).
01 WS-BALANCE           PIC 9(5)V99.

PROCEDURE DIVISION.
MAIN-PROCEDURE SECTION.
    PERFORM INITIALIZE-BALANCE
    PERFORM GET-INPUT
    PERFORM PROCESS-TRANSACTION
    STOP RUN.

INITIALIZE-BALANCE SECTION.
    OPEN OUTPUT BALANCE-FILE
    IF FILE-STATUS = "00"
        MOVE 10000.00 TO BALANCE-AMOUNT
        WRITE BALANCE-RECORD
        DISPLAY "Init File status: " FILE-STATUS
        CLOSE BALANCE-FILE
    ELSE
        DISPLAY "Failed to initialize balance.dat. Status: " FILE-STATUS
    END-IF
    OPEN INPUT BALANCE-FILE
    IF FILE-STATUS = "00"
        READ BALANCE-FILE
            AT END
                DISPLAY "Init read failed, forcing
